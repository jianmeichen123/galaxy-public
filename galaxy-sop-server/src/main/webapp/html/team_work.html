<div class="qualificationstc">

	
	
    <div class="qualifications_all" id="learning">
        <form action="" id="work_form" method="post">
            <input name="id" style="display:none;">
            <input name="index" style="display:none;">
           <div class="info clearfix">
            <dl class="fmdl fl">
                <dt>&nbsp;任职时间：</dt>
                <dd class="clearfix"/>
                <input readonly="" name="field1" class="datepicker-month-text fl txt time" id="startWorkDate" type="text" data-date-format="yyyy-mm">
                	<span class="fl">&nbsp;至&nbsp;</span>
                <input readonly="" name="field2" class="datepicker-month-text fl txt time" id="endWorkDate" type="text" data-date-format="yyyy-mm">
                </dd>
            </dl>  
            <dl class="fmdl fl">
                <dt>任职公司：</dt>
                <dd class="clearfix">
                    <input name="field3" type="text" class="txt" maxlength="100"/>
                </dd>
            </dl>
            <dl class="fmdl fl">
                <dt>任职职位：</dt>
                <dd><input name="field4" type="text" class="txt" maxlength="100"/></dd>
            </dl>
            <dl class="fmdl fl">
                <dt>工作内容简述：</dt>
                <dd>
                   <textarea name ="field5" class="team_textarea"  maxlength="100" ></textarea>
                </dd>
            </dl>
        </div>
        </form>
    </div>
    
    <div class="button_affrim">
        <a href="javascript:;"  class="register_all_affrim fl add_team_work" >确定</a>
        <a href="javascript:;"  class="register_all_input fr" id="close_work" data-close="close">取消</a>
    </div>
</div>
<script>
    $(function(){
        $("#work_form").validate({
             submitHandler:function(form){
                 save_work();
             }
        });
    })
    function save_work(){
         var json ={};
        $.each($("#work_form").find("input, select,textarea"),function(){
            var ele = $(this);
            var name = ele.attr('name');
            json[name]= ele.val();
            if(name.indexOf("field")>-1 && name != "field5"){
               if(ele.val()){
                    json[name]= ele.val();
               }else{
                    json[name]="未知"
               }
            }
        });

        var index = json["index"];
        if(!index){
            //新增一条记录
            var str="<div data-flag><div class='team_p_one'><span class='team_ico team_ico_dot'></span><span name='id' style='display:none'>"+json["id"]+"</span>";
            if(json["field1"]){
              str = str+"<span name='field1'>"+json["field1"]+"</span><span>～</span>";
            }
            if(json["field2"]){
                str = str+"<span name='field2'>"+json["field2"]+"</span>"
            }
            str = str+ "</div><div class='team_p_two'>"+
                "<ul>"+
                    "<li><span>公司：</span><span name='field3'>"+json['field3']+"</span></li>"+
                    "<li><span>职位：</span><span name='field4'>"+json['field4']+"</span></li>"+
                "</ul>"+
                "<div class='team_click'>"+
                    "<span class='blue '  onclick='editWork(this)'   >编辑</span>"+
                    "<span class='blue' onclick='delete_row(this)' >删除</span>"+
                "</div>"+
            "</div>"+
            "<div class='team_p_two'><span  name='field5'>"+json['field5']+"</span></div></div>";
            $("#team_work").append(str);
        }else{
                var div = $("#team_work").find("div[data-flag]:eq("+index+")");

                var list = div.find("*[name]");
                $(list).each(function(){
                      var key = $(this).attr("name");
                      $(this).html(json[key]);
                })
        }
        $("#close_work").click();
    }
     //日期
     var currDate = new Date();
     var currYear=currDate.getFullYear();
     $("#startWorkDate").datetimepicker({
    	minView: 'month',
    	startView:3,
        minView:3,
    	endDate:currYear,//结束时间，在这时间之后都不可选
    	language: 'zh-CN',
    	autoclose:true
    }).on('changeDate' , function(ev){
    	var starttime = $("#startWorkDate").val();
    	$('#endWorkDate').datetimepicker('setStartDate',starttime);
    });
    $("#endWorkDate").datetimepicker({
    	minView: 'year',
    	startView:3,
        minView:3,
    	endDate:currYear,//结束时间，在这时间之后都不可选
    	language: 'zh-CN',
    	autoclose:true
    }).on('changeDate' , function(ev){
    	var endtime = $('#endWorkDate').val();
    	$('#startWorkDate').datetimepicker('setEndDate',endtime);
    });

    $(".add_team_work").on("click",function(){
            $("#work_form").submit();
    })
</script>
